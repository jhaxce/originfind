# Recent Changes - December 5, 2025

## Output File Generation Behavior Changed

### Previous Behavior ❌
- Output files were **automatically generated** by default
- Format: `domain.com-{mode}-YYYY-MM-DD_HH-MM-SS.txt`
- No way to suppress file creation

### New Behavior ✅
- Output files are **NOT generated** unless `-o` flag is used
- **Console only** (default): No `-o` flag → Results displayed on console, no file created
- **Custom filename**: `-o results.txt` → Saves to `results.txt`
- **No auto-generated filenames**: Must always specify filename explicitly

### Examples

```powershell
# Console only (NO file created)
.\origindive.exe -d target.com -c 1.2.3.4/32

# Save to custom filename
.\origindive.exe -d target.com -c 1.2.3.4/32 -o results.txt

# Save with JSON format
.\origindive.exe -d target.com -c 1.2.3.4/32 -o results.json -f json
```

### Migration Guide

If you relied on auto-generated filenames, now specify explicit filenames:

**Before**:
```powershell
.\origindive.exe -d example.com -c 1.2.3.0/24
# Auto-created: example.com-active-2025-12-05_18-30-45.txt
```

**After**:
```powershell
.\origindive.exe -d example.com -c 1.2.3.0/24 -o example-scan.txt
# Explicit: example-scan.txt
```

### Rationale
- **User control**: No surprise files cluttering directory
- **Explicit intent**: Output files only when requested
- **Standard behavior**: Matches common CLI tool patterns (grep, curl, etc.)

---

## Test Files Reorganized

### Changes
1. **Removed**: `test_proxy.go` (not following `*_test.go` convention)
2. **Moved**: `test_proxy_flags.ps1` → `scripts/test_proxy_flags.ps1`

### Test File Naming Convention
- **Unit tests**: `*_test.go` (e.g., `parser_test.go`, `validator_test.go`)
- **Scripts**: Place in `scripts/` folder
- **Integration tests**: `*_integration_test.go` (gitignored)
- **Coverage tests**: `*_coverage_test.go` (gitignored)

### Current Test Structure
```
pkg/
  ip/
    parser_test.go      ✅ Unit tests for IP parsing
    validator_test.go   ✅ Unit tests for IP validation
  # Other packages...

scripts/
  build.ps1                  ✅ Build automation
  test_proxy_flags.ps1       ✅ Proxy flags testing
```

---

## Summary of Changes

| Change | Old Behavior | New Behavior |
|--------|--------------|--------------|
| **Output files** | Auto-generated by default | Only when `-o filename` specified |
| **Console output** | Suppressed if file created | Always shown (unless `-q`) |
| **test_proxy.go** | In root directory | Removed (not `*_test.go` format) |
| **test_proxy_flags.ps1** | In root directory | Moved to `scripts/` |

---

## Testing

```powershell
# Build
go build -ldflags="-s -w" -o origindive.exe cmd/origindive/main.go

# Test 1: No output file (console only)
.\origindive.exe -d httpbin.org -c 3.93.94.85/32
# ✅ Should show results on console, create NO files

# Test 2: Custom output file
.\origindive.exe -d httpbin.org -c 3.93.94.85/32 -o test.txt
# ✅ Should create test.txt with results

# Test 3: JSON output
.\origindive.exe -d httpbin.org -c 3.93.94.85/32 -o test.json -f json
# ✅ Should create test.json with JSON-formatted results
```

All tests passed ✅
